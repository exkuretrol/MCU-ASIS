# 事前準備 {#intro}

## 引言

應用於實體電腦之前，我們會在虛擬機器內先執行過一遍，確認操作沒問題後，才會在實體點腦上操作。這裡我選用 VirtualBox 作為示範。

## 安裝 VirtualBox

先到 [VirtualBox 官方網站](https://www.virtualbox.org/wiki/Downloads)的下載頁面，下載適合你電腦系統的安裝執行檔，假如是 Windows 系統就點擊 「Windows hosts」的下載連結，如果是其他作業系統就根據你的作業系統下載對應的檔案。

![](figures/www.virtualbox.org-downloads-page.png "official virtualbox downloads page"){.figure}

安裝的過程中只需使用預設的設定即可，預設設定做了安裝虛擬機器的驅動程式、關聯檔案...等等，正常安裝不需要變更它。

![](figures/virtual-box-installer.png "virtualbox installer"){.figure}

## 於虛擬機器安裝作業系統

再安裝完 VirtualBox 後，打開並不會有預先安裝好的作業系統，需要在 VirtualBox 內自行安裝作業系統。首先介紹 VirtualBox 的使用者介面:

```{r virtualbox-menu, fig.align='center', fig.cap='VirtualBox 的操作介面', echo=FALSE}
knitr::include_graphics("./figures/virtualbox-menu.png", dpi = NA)
```

如 \@ref(fig:virtualbox-menu) 所示，右邊主要功能圖示由左而右的功能分別是:

1.  `喜好設定`: 設定 VirtualBox 的整體設定，像是軟體語言、虛擬機器預設存放位置...等等
2.  `匯入`: 匯入虛擬機器檔案 (.ovf)
3.  `匯出`: 匯出虛擬機器檔案
4.  `新增`: 新增*新的*虛擬主機
5.  `加入`: 加入*已經存在的*虛擬主機

### 新增 Ubuntu 作業系統設定

所以要新增新的虛擬機器是按「新增」。

![](figures/new-virtual-machine_0.png "new virtual machine"){.figure}

這裡先點選「專家模式」，專家模式可以一併設定虛擬機器的所有設定。

![](figures/new-virtual-machine.png "new virtual machine"){.figure}

記憶體大小根據每個人電腦的性能做調整，虛擬主機沒用來做什麼事最多4Gb (4 \* 1024Mb) 就很夠用了。這裡要注意的一點是，虛擬機器的存放位置，當你要轉移虛擬機器時才不會找不到。

預設的虛擬機器存放位置位於使用者資料夾中的`Virtual VMs`資料夾，像我的使用者是qaz85，那虛擬機器就位於:

    C:\Users\qaz85\VirtualBox VMs

類型與版本記得設定為 Linux 與 Ubuntu 64位元 版本。完成之後點擊「建立」。

![](figures/new-virtual-machine_1.png "new virtual machine"){.figure}

這裡我會選 VMDK 格式的原因是因為，如果要轉移虛擬主機檔案時，單一個檔案會輕易地超過 4Gb，而超過此上限得檔案在複製時，如果目的地的裝置格式不是 ntfs 的話，會沒有辦法複製。為了預防這個問題，我在這邊先選擇 VMDK 作為我虛擬主機的檔案格式。

::: {.infobox .info}
這裡如果選擇「固定大小」會新增一個跟你設定的檔案大小一樣大的虛擬機器檔案，除非你的硬碟很大，否則不建議這麼做。
:::

<!--# TODO: 這邊可以再加如果虛擬主機已經是 VDI 格式怎麼轉換成 VMDK 格式的教學 -->

![](figures/virtual-machine-created.png "virtual machine created"){.figure}

完成後，會在 Virtual Machine 的選單左邊看見剛剛新建的虛擬機器，不過此時的虛擬機器內還沒有作業系統。

### 於 VirtualBox 安裝作業系統

在安裝作業系統之前，要先下載作業系統，因為目前的院伺服器系統是 Ubuntu 、我自己的 VPS 也是 Ubuntu ，而且我摸得比較熟的也是 Ubuntu 那有什麼理由換掉呢？所以這裡我也以 Ubuntu 作為我們院伺服器主要的系統。

![](figures/ubuntu.com-download-page.png){.figure}

進到 Ubuntu 官方網站的下載介面，這次我們選擇伺服器版本 (Ubuntu Server) 代替以往的桌面版本 (Ubuntu Desktop)。因為如果是伺服器，不需要圖形介面就可以管理了，相對於桌面版本也較節省資源。

![](figures/ubuntu.com-download-server-page.png){.figure}

選擇「Option 2 - Manual server Installation」選項之後，按上面的綠色按鈕「Download Ubuntu Server 20.04.2 LTS」會跳轉到下載頁面，開始下載 Ubuntu 系統映像檔案 (\*.iso)。

其他選項的簡易說明:

-   `Option 1 - Instant Ubuntu VMs`: Multipass 是快速部屬虛擬機器的軟體，詳細說明可以看[這裡](https://github.com/canonical/multipass)，而這裡我們已經選用 VirtualBox 了所以不會用到

-   `Option 2 - Manual server installation`: 傳統的下載映像檔案

-   `Option 3 - Automated server provisioning`: 利用 [MaaS](https://maas.io/) (Metal-as-a-Service) 安裝虛擬機。MaaS是管理數台虛擬主機用的服務，並不局限於 Ubuntu，Windows、CentOS 與 ESXi都可以在上面部屬。

![](figures/ubuntu-install-select-iso.png){.figure}

待下載完成後，開啟剛剛創建的「MCU-ASIS」虛擬主機，會跳出一個選擇啟動磁碟的訊息提示視窗，這裡我們點擊右下角的資料夾📁。

![](figures/select-iso.png){.figure}

按「加入」並選擇剛剛下載下來的映像檔案 (ubuntu-20.04.2-live-server-amd64.iso)。加入完成後按「選擇」，接著按「開始」掛載映像檔案至虛擬主機中開始安裝。

![](figures/ubuntu-configuration-select-lang.png){.figure}

稍待 Ubuntu 作業系統映像檔載入後，安裝程式會跳出選擇語言的畫面，在這裡選擇適合你的語言。
